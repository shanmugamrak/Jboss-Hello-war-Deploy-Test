name: Deploy WAR to JBoss

on:
  workflow_dispatch:
env:
  GITHUB_TOKEN: ${{ secrets.Workflow2_PAT_TOKEN_GITHUB }}
  
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        
      - name: Set up JDK 17
        uses: actions/setup-java@v3
        with:
          java-version: '17'
          distribution: 'temurin'  
          
      - name: Deploy to Jboss
        run: |
          JBOSS_ENDPOINT= ${{ secrets.JBOSS_ENDPOINT }}
          #WILDFLY_PORT= ${{ secrets.JBOSS_PORT }}
          JBOSS_USERNAME= ${{ secrets.JBOSS_USERNAME }}
          JBOSS_PASSWORD= ${{ secrets.JBOSS_PASSWORD }}
          WAR_PATH= ${{ github.workflow }}/dist/helloworld.war
          #curl -u -DJBOSS_USERNAME=$JBOSS_USERNAME -DJBOSS_PASSWORD=$JBOSS_PASSWORD -T $WAR_PATH $JBOSS_ENDPOINT/management-webapp/undeploy?name=$($WAR_PATH)
          #sleep 5
          
          curl -u -DJBOSS_USERNAME=$JBOSS_USERNAME -DJBOSS_PASSWORD=$JBOSS_PASSWORD -T $WAR_PATH $JBOSS_ENDPOINT/management-webapp/deploy?name=$($WAR_PATH)
